import{r as n,j as e,b as w,g as m,d as H}from"./index-BMILiYWd.js";import{t as E,g as U}from"./components-DlQtaEQy.js";import{a as R,b as M,c as P,u as X}from"./useTransactions-BK1OJrpO.js";import{u as Q,M as q,T as G,b as K,L as T}from"./TileLayer-BFAklQRB.js";function k(){return Q().map}function W(t){const r=k();return n.useEffect(function(){return r.on(t),function(){r.off(t)}},[r,t]),r}const Y=t=>n.createElement("svg",{id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 200 200",enableBackground:"new 0 0 200 200",xmlSpace:"preserve",...t},n.createElement("path",{fill:"currentColor",d:"M119.032,145.698h-37.4c-6.2,0-11.3-5.1-11.3-11.3v-50.7c0-1.1,0.9-2,2-2h56c1.1,0,2,0.9,2,2v50.7 C130.332,140.598,125.232,145.698,119.032,145.698z M74.332,85.698v48.7c0,4,3.3,7.3,7.3,7.3h37.3c4,0,7.3-3.3,7.3-7.3v-48.7H74.332 z"}),n.createElement("path",{fill:"currentColor",d:"M138.332,73.598h-76c-1.1,0-2-0.9-2-2s0.9-2,2-2h76c1.1,0,2,0.9,2,2S139.432,73.598,138.332,73.598z"}),n.createElement("path",{fill:"currentColor",d:"M138.332,85.598h-76c-1.1,0-2-0.9-2-2s0.9-2,2-2h76c1.1,0,2,0.9,2,2S139.432,85.598,138.332,85.598z"}),n.createElement("path",{fill:"currentColor",d:"M112.332,73.698h-24c-1.1,0-2-0.9-2-2v-6c0-6.6,5.4-12,12-12h4c6.6,0,12,5.4,12,12v6 C114.332,72.798,113.432,73.698,112.332,73.698z M90.332,69.698h20v-4c0-4.4-3.6-8-8-8h-4c-4.4,0-8,3.6-8,8V69.698z"}),n.createElement("path",{fill:"currentColor",d:"M88.732,131.698c-1.1,0-2-0.9-2-2v-32c0-1.1,0.9-2,2-2c1.1,0,2,0.9,2,2v32 C90.732,130.798,89.832,131.698,88.732,131.698z"}),n.createElement("path",{fill:"currentColor",d:"M100.732,131.698c-1.1,0-2-0.9-2-2v-32c0-1.1,0.9-2,2-2c1.1,0,2,0.9,2,2v32 C102.732,130.798,101.832,131.698,100.732,131.698z"}),n.createElement("path",{fill:"currentColor",d:"M112.732,131.698c-1.1,0-2-0.9-2-2v-32c0-1.1,0.9-2,2-2c1.1,0,2,0.9,2,2v32 C114.732,130.798,113.832,131.698,112.732,131.698z"})),V=t=>n.createElement("svg",{id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 200 200",enableBackground:"new 0 0 200 200",xmlSpace:"preserve",...t},n.createElement("path",{fill:"currentColor",d:"M124.232,129.198c-0.3,0-0.601-0.1-0.901-0.2l-23.099-11.1l-23.1,11.1c-0.6,0.3-1.1,0.3-1.7-0.1 c-0.6-0.4-0.7-1-0.7-1.7v-56c0-1.1,0.5-2.1,1.6-2.1h47.999c1.1,0,2.401,1,2.401,2.1v56c0,0.7-0.6,1.3-1.1,1.7 C125.232,129.098,124.632,129.198,124.232,129.198z M100.232,113.698c0.3,0,0.8,0.1,1.1,0.2l21.4,10.1v-50.9h-44v50.9l20.9-10.1 C99.832,113.798,99.932,113.698,100.232,113.698z"}),n.createElement("path",{fill:"currentColor",d:"M100.232,158.198c-0.4,0-0.9-0.1-1.3-0.4l-24-19.5c-0.9-0.7-1-2-0.3-2.8c0.7-0.9,2-1,2.8-0.3l22.8,18.4 l22.7-19.4c0.8-0.7,2.1-0.6,2.8,0.2s0.599,2.1-0.2,2.8l-24,20.5C101.132,157.998,100.732,158.198,100.232,158.198z"}),n.createElement("path",{fill:"currentColor",d:"M110.232,149.098h-20c-1.1,0-2-0.9-2-2c0-1.1,0.9-2,2-2h20c1.099,0,2,0.9,2,2 C112.232,148.198,111.331,149.098,110.232,149.098z"}),n.createElement("path",{fill:"currentColor",d:"M100.632,107.198c-1.1,0-2-0.9-2-2v-32c0-1.1,0.9-2,2-2c1.1,0,2,0.9,2,2v32 C102.632,106.298,101.732,107.198,100.632,107.198z"}),n.createElement("path",{fill:"currentColor",d:"M124.232,65.198h-48c-1.1,0-2-0.9-2-2v-6.8c0-8.4,6.8-15.2,15.3-15.2h21.5c8.4,0,15.2,6.8,15.2,15.3v6.7 C126.232,64.298,125.331,65.198,124.232,65.198z M78.232,61.198h44v-4.8c0-6.2-5-11.2-11.2-11.2h-21.5c-6.3,0-11.3,5-11.3,11.3 V61.198z"})),Z=()=>{const[t,r]=n.useState(null),a=n.useCallback((s,l,i,d)=>{if(l==="")return r(null),l;if(!/^-?\d*\.?\d*$/.test(l))return r("Field must be a number!"),s;if(l==="-")return i!==void 0&&i>=0?(r(`Field must be at least ${i}`),s):(r(null),l);const u=parseFloat(l);return i!==void 0&&u<i?(r(`Field must be at least ${i}`),s):d!==void 0&&u>d?(r(`Field must be at most ${d}`),s):(r(null),l)},[]);return{formError:t,setFormError:r,validateNumericInput:a}},J=()=>{const[t,r]=n.useState(!1),[a,s]=n.useState(null);return{fetchLocation:()=>(r(!0),new Promise((i,d)=>{if(!navigator.geolocation){r(!1),s("Geolocation is not supported by this browser."),d(new Error("Geolocation is not supported by this browser."));return}navigator.geolocation.getCurrentPosition(x=>{r(!1);const u={latitude:x.coords.latitude,longitude:x.coords.longitude};i(u)},x=>{r(!1),s(x.message),d(x)},{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})})),loadingLocation:t,locationError:a,setLocationError:s}},$="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",_="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",ee=T.icon({iconUrl:$,shadowUrl:_,iconSize:[25,41],iconAnchor:[12,41]});T.Marker.prototype.options.icon=ee;const te=({value:t,onChange:r})=>{const a=k();return n.useEffect(()=>{t&&a.flyTo([t.latitude,t.longitude],a.getZoom())},[t,a]),W({click(s){r({latitude:s.latlng.lat,longitude:s.latlng.lng})}}),t?e.jsx(K,{position:[t.latitude,t.longitude]}):null},re=({value:t,onChange:r})=>e.jsx("div",{style:{flex:"1 1 auto",width:"100%",minHeight:"200px",position:"relative"},children:e.jsxs(q,{center:t?[t.latitude,t.longitude]:[0,0],zoom:13,style:{height:"100%",width:"100%"},children:[e.jsx(G,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),e.jsx(te,{value:t,onChange:r})]})});function z({id:t}){const{data:r,isLoading:a}=R({id:t,enabled:!!t});return t&&a?e.jsx("div",{children:"Loading..."}):e.jsx(oe,{id:t,initialData:r})}function oe({id:t,initialData:r}){const{updateTx:a,isUpdating:s,createTx:l,isCreating:i,createTxErrorMessage:d,updateTxErrorMessage:x}=M(),{open:u,close:f}=w(),{fetchLocation:N,loadingLocation:g,locationError:v,setLocationError:b}=J(),[o,h]=n.useState({created_at:r?.created_at,amount:r?.amount?.toString()||"",title:r?.title||"",latitude:r?.location?.latitude.toString(),longitude:r?.location?.longitude.toString(),type:r?.type||"INCOME"}),{formError:j,validateNumericInput:L}=Z(),D=async()=>{try{const c=await N();h(p=>({...p,latitude:c.latitude.toString(),longitude:c.longitude.toString()})),b(null)}catch(c){console.error("Error fetching location:",c),c instanceof Error&&b(c.message)}},C=(c,p,O,B)=>{h(y=>({...y,[c]:L(y[c]||"",p,O,B)}))},F=async c=>{try{c.preventDefault();const p={title:o.title,type:o.type,created_at:o.created_at,updated_at:new Date,amount:+o.amount};o.latitude&&o.longitude&&(p.location={latitude:+o.latitude,longitude:+o.longitude}),t?(await a({id:t,payload:p}),f(),setTimeout(()=>u("Notification",e.jsx(m,{message:"Transaction changed successfully!"})),300)):(await l(p),f(),setTimeout(()=>u("Notification",e.jsx(m,{message:"Transaction added successfully!"})),300))}catch(p){u("Error",e.jsx(m,{message:`Something went wrong! ${d||x||p||""}`}))}},A=!!o.latitude!=!!o.longitude,I=!!j||A||!o.amount||!o.title;return e.jsx("div",{className:"bg-[var(--color-card)] rounded-[10px] p-[20px] mx-auto",children:e.jsxs("form",{className:"flex flex-col gap-5",onSubmit:F,children:[e.jsxs("div",{className:"flex items-center gap-5 max-[500px]:flex-col max-[500px]:items-stretch max-[500px]:gap-3",children:[e.jsx("label",{className:"text-[var(--color-text)] text-[20px] font-semibold min-w-30",htmlFor:"location",children:"Title:"}),e.jsx("input",{required:!0,type:"text",id:"title",placeholder:"Title...",value:o.title,onChange:c=>h({...o,title:c.target.value}),className:"bg-[var(--color-input)] rounded-[10px] p-[10px] w-full border-1 border-[var(--color-fixed-text)] text-[var(--color-text)] transitioned hover:border-[var(--color-hover)]"})]}),e.jsxs("div",{className:"flex items-center gap-5 max-[500px]:flex-col max-[500px]:items-stretch max-[500px]:gap-3",children:[e.jsx("label",{className:"text-[var(--color-text)] text-[20px] font-semibold min-w-30",htmlFor:"date",children:"Date:"}),e.jsx("input",{required:!0,type:"datetime-local",max:E(new Date),value:E(o.created_at||new Date),onChange:c=>h({...o,created_at:new Date(c.target.value)}),id:"date",className:"bg-[var(--color-input)] rounded-[10px] p-[10px] w-full border-1 border-[var(--color-fixed-text)] text-[var(--color-text)] transitioned hover:border-[var(--color-hover)]"})]}),e.jsxs("div",{className:"flex items-center gap-5 max-[500px]:flex-col max-[500px]:items-stretch max-[500px]:gap-3",children:[e.jsx("label",{className:"text-[var(--color-text)] text-[20px] font-semibold min-w-30",htmlFor:"amount",children:"Amount:"}),e.jsx("input",{required:!0,type:"text",inputMode:"decimal",id:"amount",min:1,placeholder:"Amount...",value:o.amount,onChange:c=>C("amount",c.target.value,1),className:"bg-[var(--color-input)] rounded-[10px] p-[10px] w-full border-1 border-[var(--color-fixed-text)] text-[var(--color-text)] transitioned hover:border-[var(--color-hover)]"})]}),e.jsxs("section",{className:"flex gap-5 items-center	",children:[e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs("div",{className:"flex items-center gap-5 max-[500px]:flex-col max-[500px]:items-stretch max-[500px]:gap-3",children:[e.jsx("label",{htmlFor:"locationLat",className:"text-[var(--color-text)] text-[20px] font-semibold min-w-30",children:"Latitude:"}),e.jsx("input",{type:"text",inputMode:"decimal",id:"locationLat",placeholder:"23,456",min:-90,max:90,value:o.latitude,onChange:c=>C("latitude",c.target.value,-90,90),className:"bg-[var(--color-input)] rounded-[10px] p-[10px] w-full border-1 border-[var(--color-fixed-text)] text-[var(--color-text)] transitioned hover:border-[var(--color-hover)]"})]}),e.jsxs("div",{className:"flex items-center gap-5 max-[500px]:flex-col max-[500px]:items-stretch max-[500px]:gap-3",children:[e.jsx("label",{htmlFor:"locationLng",className:"text-[var(--color-text)] text-[20px] font-semibold min-w-30",children:"Longitude:"}),e.jsx("input",{type:"text",inputMode:"decimal",id:"locationLng",placeholder:"23,456",min:-180,max:180,value:o.longitude,onChange:c=>C("longitude",c.target.value,-180,180),className:"bg-[var(--color-input)] rounded-[10px] p-[10px] w-full border-1 border-[var(--color-fixed-text)] text-[var(--color-text)] transitioned hover:border-[var(--color-hover)]"})]}),e.jsx("button",{type:"button",disabled:g,onClick:D,className:"not-disabled:cursor-pointer bg-[var(--color-card)] rounded-[10px] p-[10px] text-[var(--color-text)] border-1 border-[var(--color-fixed-text)] transitioned not-disabled:hover:border-[var(--color-hover)] not-disabled:hover:text-[var(--color-hover)] not-disabled:hover:scale-95 text-[16px] font-bold",children:"Get current location"})]}),e.jsx("div",{className:"w-full h-full flex overflow-hidden",children:e.jsx(re,{value:o.longitude&&o.latitude?{latitude:+o.latitude,longitude:+o.longitude}:void 0,onChange:c=>h({...o,longitude:c.longitude.toString(),latitude:c.latitude.toString()})})})]}),e.jsxs("div",{className:"flex gap-7 items-center justify-center max-[500px]:flex-col max-[500px]:items-stretch max-[500px]:gap-3",children:[e.jsxs("label",{className:"text-[var(--color-text)] text-[20px] font-semibold",children:[e.jsx("input",{className:"mr-3",type:"radio",name:"transactionType",checked:o.type==="INCOME",onChange:()=>h({...o,type:"INCOME"})}),"Income"]}),e.jsxs("label",{className:"text-[var(--color-text)] text-[20px] font-semibold",children:[e.jsx("input",{className:"mr-3",type:"radio",name:"transactionType",checked:o.type==="EXPENSE",onChange:()=>h({...o,type:"EXPENSE"})}),"Outcome"]})]}),e.jsxs("div",{className:"min-h-[24px]",children:[j&&e.jsxs("p",{className:"text-red-500 text-sm animate-pulse",children:["⚠️ ",j]}),A&&e.jsx("p",{className:"text-red-500 text-sm animate-pulse",children:"⚠️ Fill both location fields or leave them empty"}),v&&e.jsxs("p",{className:"text-red-500 text-sm animate-pulse",children:["⚠️ ",v]})]}),e.jsx("button",{disabled:i||s||I,type:"submit",className:"bg-[var(--color-hover)] text-[var(--color-fixed)] rounded-[10px] p-[10px] w-full not-disabled:hover:bg-[var(--color-hover-reverse)] not-disabled:hover:text-[var(--color-hover)] transitioned cursor-pointer disabled:cursor-not-allowed",children:i||s?"Processing...":t?"Save Changes":"Create Transaction"})]})})}function ae({id:t}){const{open:r,close:a}=w(),{deleteTx:s,deleteTxErrorMessage:l,isDeleting:i}=M(),d=async()=>{try{await s(t),a(),setTimeout(()=>r("Notification",e.jsx(m,{message:"Transaction deleted successfully!"})),300)}catch(x){console.error(x),a(),setTimeout(()=>r("Notification",e.jsx(m,{message:`Something went wrong: ${l}`})),300)}};return e.jsx("div",{children:e.jsxs("div",{className:"flex flex-col p-3 justify-center items-center transitioned text-[var(--color-text)] text-2xl",children:[e.jsx("h1",{children:"Are you sure you want to delete this transaction?"}),e.jsxs("div",{className:"flex gap-3 justify-center items-center mt-[30px]",children:[e.jsx("button",{onClick:d,disabled:i,className:"px-3 py-2 cursor-pointer bg-[var(--bg-red)] rounded transitioned hover:bg-transparent border-2 border-[var(--bg-red)]",children:i?"Deleting...":"Delete"}),e.jsx("button",{onClick:a,className:"px-3 py-2 cursor-pointer bg-[var(--bg-green)] rounded transitioned hover:bg-transparent border-2 border-[var(--bg-green)] ",children:"Cancel"})]})]})})}function S({data:t}){const{open:r}=w(),a=l=>()=>r("Change transaction",e.jsx(z,{id:l},l)),s=l=>()=>r("Delete transaction",e.jsx(ae,{id:l}));return e.jsxs("div",{className:"grid grid-cols-8 items-center gap-4 p-3 rounded border border-[var(--color-fixed-text)] text-[var(--color-text)] transitioned roboto text-[18px] max-[1300px]:grid-cols-7 max-[1000px]:grid-cols-6 max-[970px]:grid-cols-3 max-[450px]:grid-cols-2",children:[e.jsx("span",{className:"justify-self-center px-2 truncate break-all whitespace-normal text-center",children:t.title}),e.jsxs("span",{className:"justify-self-center px-2 font-semibold",children:["$",Number(t.amount).toFixed(2)]}),e.jsx("span",{className:`justify-self-center py-2 px-5 text-sm rounded-xl text-gray-40 ${t.type==="INCOME"?"bg-[var(--bg-green)]":"bg-[var(--bg-red)]"}`,children:t.type==="INCOME"?"Income":"Outcome"}),e.jsx("span",{className:"col-span-2 max-[1000px]:col-span-1 justify-self-center px-2 break-words whitespace-normal text-center",children:`${new Date(t.created_at||0).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"})} ${new Date(t.created_at||0).toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})}`}),e.jsx("span",{className:"text-center col-span-2 max-[1300px]:col-span-1 justify-self-center px-2 break-words whitespace-normal",children:t.location?`${t.location.latitude.toFixed(3)}, ${t.location.longitude.toFixed(3)}`:"No location"}),e.jsxs("span",{className:"flex gap-3 max-[1200px]:flex-col max-[1200px]:justify-self-center max-[1200px]:gap-1 max-[970px]:flex-row",children:[e.jsx("button",{onClick:a(t.id),className:"rotate-[45deg] w-14 h-14 justify-self-center cursor-pointer p-1 hover:text-[var(--color-hover)] rounded transitioned hover:scale-110",children:e.jsx(V,{})}),e.jsx("button",{onClick:s(t.id),className:"w-14 h-14 justify-self-center cursor-pointer p-1 hover:text-[var(--color-hover)] rounded transitioned hover:scale-110",children:e.jsx(Y,{})})]})]})}const ne=({searchQuery:t,setDebouncedSearchQuery:r})=>{const[a,s]=n.useState(t);n.useEffect(()=>{const i=setTimeout(()=>{r(a)},500);return()=>clearTimeout(i)},[a,r]);const l=i=>{s(i.target.value)};return e.jsx("input",{type:"text",placeholder:"Search",value:a,onChange:l,className:"bg-[var(--color-card)] rounded-[10px] p-[10px] w-[300px] border-1 border-[var(--color-fixed-text)] text-[var(--color-text)] transitioned hover:border-[var(--color-hover)] text-[16px] font-semibold"})};function se(t){const r=n.useRef(t);n.useEffect(()=>{r.current=t},[t]);const a=n.useRef(()=>{});return n.useCallback(s=>{if(a.current(),!s)return;const l=new IntersectionObserver(i=>{i.forEach(d=>{d.isIntersecting&&r.current()})});l.observe(s),a.current=()=>l.disconnect()},[])}function xe(){const{user:t}=H(),[r]=n.useState(""),[a,s]=n.useState(""),{fetchNextPage:l,data:i,isFetchingNextPage:d,hasNextPage:x}=P({perPage:10,userId:t?.id}),u=i?.pages.flatMap(o=>o.data)??[],{data:f}=X({userId:t?.id}),N=se(()=>{x&&!d&&l()}),g=U(f,a),{open:v}=w(),b=()=>()=>v("Add transaction",e.jsx(z,{}));return t?.id===null?e.jsx(m,{message:"You are not logged in. Please log in to see your transactions."}):e.jsxs("section",{className:"w-full",children:[e.jsxs("div",{className:"flex justify-between max-[970px]:flex-col items-center gap-6 mb-[27px]",children:[e.jsx("h1",{className:"text-[var(--color-title)] text-[32px] font-semibold",children:"Transactions"}),e.jsxs("div",{className:"flex gap-3 max-[400px]:flex-col justify-center",children:[e.jsx(ne,{searchQuery:r,setDebouncedSearchQuery:s}),e.jsx("button",{disabled:!t?.id,onClick:b(),className:"bg-[var(--color-card)] rounded-[10px] p-[10px] text-[var(--color-text)] border-1 border-[var(--color-fixed-text)] transitioned not-disabled:cursor-pointer not-disabled:hover:border-[var(--color-hover)] not-disabled:hover:text-[var(--color-hover)] not-disabled:hover:scale-95 text-[16px] font-bold",children:"Add new"})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[t?.id&&!a&&e.jsxs(e.Fragment,{children:[u.map(o=>e.jsx(S,{data:o},o.id)),x&&e.jsx("div",{ref:N,className:"h-4 w-full",children:d&&e.jsx(m,{message:"Loading more..."})}),!x&&u.length>0&&e.jsx(m,{message:"No more transactions"})]}),a&&e.jsx(e.Fragment,{children:g&&g.data.length>0?g.data.map(o=>e.jsx(S,{data:o},o.id)):e.jsx(m,{message:"No transactions found"})})]})]})}export{xe as Transactions};
